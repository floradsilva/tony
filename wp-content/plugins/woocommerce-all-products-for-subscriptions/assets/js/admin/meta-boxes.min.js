jQuery(function(o){var n=o("#wcsatt_data"),t=n.find(".general_scheme_options"),i=t.find("input#_wcsatt_allow_one_off"),e=t.find("select#_wcsatt_default_status"),s=t.find("textarea#_wcsatt_subscription_prompt"),c=n.find(".subscription_schemes"),a=c.find(".subscription_scheme"),r=a.length,_={message:null,overlayCSS:{background:""!==wcsatt_admin_params.post_id?"#fff":"#f1f1f1",opacity:.6}};function p(){0<a.length?(i.prop("disabled",!1),e.prop("disabled",!1),s.prop("disabled",!1)):(i.prop("checked",!0).change(),i.prop("disabled",!0),e.prop("disabled",!0),s.prop("disabled",!0))}function d(){0<a.length?n.removeClass("planless"):n.addClass("planless")}function u(){var t=o("select#product-type").val(),i=a.length;"subscription"!==t&&"variable-subscription"!==t&&(0<i?o(".subscription_one_time_shipping").show():o(".subscription_one_time_shipping").hide())}function h(){a.each(function(t,i){o(".position",i).val(parseInt(o(i).index(".subscription_schemes .subscription_scheme"),10)),o(i).attr("rel",t)})}o.fn.wcsatt_init_help_tips=function(){o(this).find(".help_tip, .tips, .woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})},o.fn.wcsatt_init_type_dependent_inputs=function(){var t=o("select#product-type").val(),i="variable"===t?wcsatt_admin_params.i18n_override_option_variable:wcsatt_admin_params.i18n_override_option,n="variable"===t?wcsatt_admin_params.i18n_inherit_option_variable:wcsatt_admin_params.i18n_inherit_option,e="variable"===t?wcsatt_admin_params.i18n_discount_description_variable:wcsatt_admin_params.i18n_discount_description;o(this).find('.subscription_pricing_method_input [value="inherit"]').text(n),o(this).find('.subscription_pricing_method_input [value="override"]').text(i),o(this).find(".subscription_price_discount .woocommerce-help-tip").attr("data-tip",e).wcsatt_init_help_tips()},o.fn.wcsatt_refresh_scheme_lengths=function(){var n=o(this).find(".wc_input_subscription_length"),t=o(this).find(".wc_input_subscription_period"),i=o(this).find(".wc_input_subscription_period_interval"),e=n.val(),s=parseInt(i.val(),10),c=!1;n.empty(),o.each(wcsatt_admin_params.subscription_lengths[t.val()],function(t,i){0!=parseInt(t,10)&&0!=parseInt(t,10)%s||n.append(o("<option></option>").attr("value",t).text(i))}),n.children("option").each(function(){if(this.value==e)return!(c=!0)}),c?n.val(e):n.val(0)},""===wcsatt_admin_params.post_id&&(n.on("click","h3",function(){var t=o(this).closest(".wc-metabox"),i=t.find(".wc-metabox-content");t.hasClass("closed")?i.show():i.hide(),t.toggleClass("closed")}),n.find(".wc-metabox").each(function(){var t=o(this),i=t.find(".wc-metabox-content");t.hasClass("closed")&&i.hide()})),o.fn.wcsatt_refresh_sync_options=function(){var t=o(this).find(".wc_input_subscription_period"),i=o(this).find(".subscription_sync"),n=i.find(".subscription_sync_annual"),e=i.find(".subscription_sync_week_month"),s=e.find("select"),c=t.val();"day"===c?(i.hide(),s.val(0),n.find('input[type="number"]').val(0)):(i.show(),"year"===c?(e.hide(),n.find('input[type="number"]').val(0),s.val(0),n.show()):(n.hide(),n.find('input[type="number"]').val(0),s.empty(),o.each(WCSubscriptions.syncOptions[c],function(t,i){t||(i=wcsatt_admin_params.i18n_do_no_sync),s.append(o("<option></option>").attr("value",t).text(i))}),e.show()))},"yes"===wcsatt_admin_params.is_onboarding&&setTimeout(function(){o(".satt_options a").trigger("click")},500),o("select#product-type").change(function(){0<a.length&&a.wcsatt_init_type_dependent_inputs(),d(),p(),u()}).change(),n.on("woocommerce_subscription_schemes_changed",function(){a=c.find(".subscription_scheme"),h(),d(),p(),u()}).one("woocommerce_subscription_scheme_added",function(){n.removeClass("onboarding")}),c.on("change","select.subscription_pricing_method_input",function(){var t=o(this).val();o(this).closest(".subscription_scheme_product_data").find(".subscription_pricing_method").hide(),o(this).closest(".subscription_scheme_product_data").find(".subscription_pricing_method_"+t).show()}).on("change",".wc_input_subscription_period",function(){o(this).closest(".subscription_scheme").wcsatt_refresh_scheme_lengths(),o(this).closest(".subscription_scheme").wcsatt_refresh_sync_options()}),n.on("click","span.scheme-remove",function(){var t=o(this).closest(".subscription_scheme");return t.find("*").off(),t.remove(),n.trigger("woocommerce_subscription_schemes_changed"),!1}).on("click",".remove_all",function(){return n.hasClass("no_plans")||(a.each(function(t,i){var n=o(i);n.find("*").off(),n.remove()}),n.trigger("woocommerce_subscription_schemes_changed")),!1}).on("click","button.add_subscription_scheme",function(){n.block(_),r++;var t={action:"wcsatt_add_subscription_scheme",post_id:wcsatt_admin_params.post_id,index:r,security:wcsatt_admin_params.add_subscription_scheme_nonce};return o.post(wcsatt_admin_params.wc_ajax_url,t,function(t){c.append(t.markup);var i=c.find(".subscription_scheme").last();i.wcsatt_init_type_dependent_inputs(),i.wcsatt_init_help_tips(),i.find("select.subscription_pricing_method_input").change(),n.unblock(),n.trigger("woocommerce_subscription_scheme_added",t),n.trigger("woocommerce_subscription_schemes_changed")},"json"),!1}),i.on("change",function(){o(this).is(":checked")?n.find(".wcsatt_default_status").show():n.find(".wcsatt_default_status").hide()}).change(),o("#_nyp").on("change",function(){o(this).is(":checked")?c.addClass("is_nyp"):c.removeClass("is_nyp")}).change(),function(){c.find("select.subscription_pricing_method_input").change();var t=a.get();t.sort(function(t,i){var n=parseInt(o(t).attr("rel"),10),e=parseInt(o(i).attr("rel"),10);return n<e?-1:e<n?1:0}),o(t).each(function(t,i){c.append(i)}),c.sortable({items:".subscription_scheme",cursor:"move",axis:"y",handle:"span.scheme-handle",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(t,i){i.item.css("background-color","#f6f6f6")},stop:function(t,i){i.item.removeAttr("style"),h()}})}()});