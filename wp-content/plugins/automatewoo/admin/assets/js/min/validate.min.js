!function(a,e){var o;AW.Validate={errorMessages:{},init:function(){setInterval(function(){"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave(),a(".automatewoo-field-wrap textarea.wp-editor-area").each(function(){a(this).attr("data-automatewoo-validate","variables"),o.validateField(a(this))})},2e3),a(document.body).on("keyup blur change","[data-automatewoo-validate]",function(e){o.validateField(a(e.target))}),o.validateAllFields()},validateAllFields:function(){a("[data-automatewoo-validate]").each(function(){o.validateField(a(this))})},validateField:function(e){if(AW.workflow){var r=[],a=e.val();o.clearFieldErrors(e);var t=AW.Validate.getVariablesFromText(a);if(o.fieldSupports("variables",e)){var i=AW.workflow.get("trigger");_.each(t,function(e){var a=o.isVariableValidForTrigger(e,i);!0!==a&&r.push(o.getErrorMessage(a,o.getVariableWithoutParams(e)))})}else t&&r.push(o.getErrorMessage("noVariablesSupport"));r.length&&o.setFieldErrors(e,r)}},setFieldErrors:function(e,a){e.addClass("automatewoo-field--invalid");var r=e.parents(".automatewoo-field-wrap:first");r.append('<div class="automatewoo-field-errors"></div>');var t=r.find(".automatewoo-field-errors");e.is(".wp-editor-area")&&r.find(".wp-editor-container").addClass("automatewoo-field--invalid"),_.each(a,function(e){t.append('<div class="automatewoo-field-errors__error">'+e+"</div>")})},clearFieldErrors:function(e){var a=e.parents(".automatewoo-field-wrap:first");e.removeClass("automatewoo-field--invalid"),e.is(".wp-editor-area")&&a.find(".wp-editor-container").removeClass("automatewoo-field--invalid"),a.find(".automatewoo-field-errors").remove()},fieldSupports:function(e,a){var r=a.data("automatewoo-validate").split(" ");return-1!==_.indexOf(r,e)},isVariableValidForTrigger:function(e,a){var r=o.getDataTypeFromVariable(e),t=o.getDataFieldFromVariable(e);if(r&&-1===_.indexOf(a.supplied_data_items,r))return"invalidDataType";var i=AW.workflow.get("variables");return!i||!i[r]||-1!==i[r].indexOf(t)||"invalidVariable"},getVariablesFromText:function(e){var r=e.match(/{{(.*?)}}/g);return!!r&&(_.each(r,function(e,a){r[a]=e.replace(/{|}/g,"").trim()}),r)},getVariableWithoutParams:function(e){return e.replace(/(\|.*)/,"")},getDataTypeFromVariable:function(e){return-1!==e.indexOf(".")&&e.replace(/(\..*)/,"")},getDataFieldFromVariable:function(e){var a=(e=o.getVariableWithoutParams(e)).indexOf(".");return-1!==a&&e.substring(a+1).trim()},getErrorMessage:function(e,a){if(!o.errorMessages[e])return"Unknown error, please try refreshing your browser.";var r=o.errorMessages[e];return"string"==typeof a&&(r=r.replace("%s",a)),r}},(o=AW.Validate).errorMessages=e}(jQuery,automatewooValidateLocalizedErrorMessages);
//# sourceMappingURL=validate.min.js.map
